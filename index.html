<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8">
  <title>Editor Layout Akun (HD)</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    canvas { display:none; }
  </style>
</head>
<body class="min-h-screen flex flex-col items-center bg-yellow-400" style="background-color:#FFD700;">
  <div class="w-full max-w-7xl px-2 flex flex-col items-center">
    <h1 class="text-2xl font-bold mt-4 mb-4 text-gray-900">Editor Layout Akun (HD)</h1>

    <!-- Upload -->
    <label class="bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded cursor-pointer mb-3">
      üìÇ Pilih Gambar
      <input type="file" id="upload" multiple accept="image/*" class="hidden">
    </label>

    <!-- Control -->
    <div class="flex flex-wrap gap-2 mb-4 justify-center">
      <select id="layout" class="p-2 border rounded">
        <option value="2">2 Kolom</option>
        <option value="3">3 Kolom</option>
        <option value="4" selected>4 Kolom</option>
        <option value="5">5 Kolom</option>
        <option value="6">6 Kolom</option>
        <option value="7">7 Kolom</option>
        <option value="8">8 Kolom</option>
      </select>
      <button id="download" class="bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded">
        ‚¨áÔ∏è Download HD
      </button>
    </div>

    <!-- Preview Grid -->
    <div id="preview" class="grid gap-[2px] w-full"></div>

    <canvas id="canvas"></canvas>
  </div>

  <script>
    const upload = document.getElementById('upload');
    const preview = document.getElementById('preview');
    const layout = document.getElementById('layout');
    const downloadBtn = document.getElementById('download');
    const canvas = document.getElementById('canvas');

    let images = [];

    upload.addEventListener('change', e => {
      images = Array.from(e.target.files);
      render();
    });

    layout.addEventListener('change', render);

    function render(){
      preview.innerHTML = '';
      if(images.length === 0) return;

      const cols = parseInt(layout.value);
      preview.className = `grid gap-[2px] w-full grid-cols-${cols}`;

      images.forEach(file=>{
        const img = document.createElement('img');
        img.src = URL.createObjectURL(file);
        img.className = "w-full h-auto object-cover";
        preview.appendChild(img);
      });
    }

    downloadBtn.addEventListener('click', async ()=>{
      if(images.length===0) return;
      const cols = parseInt(layout.value);
      const size = 400; // tiap kotak 400px (HD)
      const rows = Math.ceil(images.length / cols);

      canvas.width = cols * (size + 2); 
      canvas.height = rows * (size + 2);
      const ctx = canvas.getContext('2d');

      ctx.fillStyle = "#FFD700"; // kuning emas background
      ctx.fillRect(0,0,canvas.width,canvas.height);

      for(let i=0;i<images.length;i++){
        const imgFile = images[i];
        const img = new Image();
        img.src = URL.createObjectURL(imgFile);
        await img.decode();

        const x = (i % cols) * (size + 2);
        const y = Math.floor(i / cols) * (size + 2);
        ctx.drawImage(img, x, y, size, size);
      }

      const link = document.createElement('a');
      link.download = 'layout-hd.png';
      link.href = canvas.toDataURL('image/png');
      link.click();
    });
  </script>
</body>
</html>